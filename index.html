<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Free online image converter with batch processing, compression, and auto-ZIP support">
    <title>Image Converter Pro - Convert, Compress & Batch Process</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#6366f1">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="apple-touch-icon" href="icon-192.png">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-top">
                <div></div>
                <button class="theme-toggle" id="themeToggle" title="Toggle Light/Dark Theme">
                    <span class="theme-icon">üåô</span>
                </button>
            </div>
            <h1>üñºÔ∏è Image Converter Pro</h1>
            <p class="subtitle">Convert, compress, and batch process images instantly</p>
        </header>

        <!-- Upload Section -->
        <section class="upload-section">
            <div class="upload-area" id="uploadArea">
                <div class="upload-content">
                    <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="17 8 12 3 7 8"></polyline>
                        <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                    <h2>Drag & Drop Image(s) Here</h2>
                    <p>or click to browse files (single or multiple images)</p>
                    <p class="formats">Supports: PNG, JPG, JPEG, WEBP, BMP, TIFF, GIF, SVG, AVIF, HEIC</p>
                    <p class="formats" style="margin-top: 10px; font-weight: 600;">‚úì Upload 1 image or many images at once</p>
                    <input type="file" id="fileInput" multiple accept="image/*" webkitdirectory="" hidden>
                    <input type="file" id="folderInput" multiple webkitdirectory="" hidden>
                </div>
            </div>
        </section>

        <!-- Settings Panel -->
        <section class="settings-panel" id="settingsPanel" style="display: none;">
            <h3>‚öôÔ∏è Conversion Settings</h3>
            
            <!-- Preset Packs Section -->
            <div class="presets-section">
                <h4>üéØ Quick Presets (Auto-Generate Multiple Sizes)</h4>
                <div class="preset-buttons">
                    <button class="preset-btn" data-preset="none">None (Custom)</button>
                    <button class="preset-btn" data-preset="logo">Logo Pack</button>
                    <button class="preset-btn" data-preset="favicon">Favicon Pack</button>
                    <button class="preset-btn" data-preset="android">Android Icons</button>
                    <button class="preset-btn" data-preset="ios">iOS Icons</button>
                    <button class="preset-btn" data-preset="social">Social Media</button>
                    <button class="preset-btn" data-preset="all">All Sizes</button>
                    <button class="preset-btn" data-preset="custom-list">Custom Size List</button>
                </div>
                <div class="preset-info" id="presetInfo"></div>
            </div>

            <!-- Custom Size List Builder -->
            <div class="custom-size-list-section" id="customSizeListSection" style="display: none;">
                <h4>üìè Build Your Custom Size List</h4>
                <div class="add-size-form">
                    <div class="size-inputs">
                        <input type="number" id="newSizeWidth" placeholder="Width" min="1" class="size-input">
                        <span class="size-separator">√ó</span>
                        <input type="number" id="newSizeHeight" placeholder="Height" min="1" class="size-input">
                        <button class="btn btn-primary" id="addSizeBtn">+ Add Size</button>
                    </div>
                    <label style="display: flex; align-items: center; margin-top: 10px; gap: 8px;">
                        <input type="checkbox" id="newSizeKeepAspect">
                        Keep aspect ratio (auto-calculate one dimension)
                    </label>
                </div>
                <div class="custom-sizes-list" id="customSizesList">
                    <p class="empty-message">No custom sizes added yet. Click "+ Add Size" to start building your list.</p>
                </div>
                <div class="custom-list-actions">
                    <button class="btn btn-secondary" id="clearSizeListBtn">üóëÔ∏è Clear All Sizes</button>
                    <button class="btn btn-secondary" id="saveSizeListPresetBtn">üíæ Save as Preset</button>
                </div>
            </div>

            <!-- Basic Settings - Always Visible -->
            <div class="settings-section basic-settings">
                <h4>‚öôÔ∏è Basic Settings</h4>
                <div class="settings-grid">
                    <div class="setting-group">
                        <label for="outputFormat">Output Format</label>
                        <select id="outputFormat">
                            <option value="png">PNG</option>
                            <option value="jpg">JPG / JPEG</option>
                            <option value="jpeg">JPEG</option>
                            <option value="webp">WebP</option>
                            <option value="svg">SVG</option>
                            <option value="bmp">BMP</option>
                            <option value="gif">GIF</option>
                            <option value="ico">ICO (Favicon)</option>
                            <option value="avif">AVIF</option>
                            <option value="tiff">TIFF</option>
                        </select>
                    </div>

                    <div class="setting-group">
                        <label for="quality">Quality <span id="qualityValue">80</span>%</label>
                        <input type="range" id="quality" min="1" max="100" value="80">
                    </div>

                    <div class="setting-group">
                        <label for="resizeMode">Resize Mode</label>
                        <select id="resizeMode">
                            <option value="none">No Resize</option>
                            <option value="fit">Fit (Maintain Aspect)</option>
                            <option value="fill">Fill (Crop to Fit)</option>
                            <option value="stretch">Stretch (Distort)</option>
                            <option value="custom">Custom Dimensions</option>
                            <option value="circular">Circular Crop</option>
                        </select>
                    </div>

                    <div class="setting-group" id="resizeDimensions" style="display: none;">
                        <label for="resizeType">Size Type</label>
                        <select id="resizeType">
                            <option value="pixels">Pixels (Width √ó Height)</option>
                            <option value="percentage">Percentage</option>
                            <option value="maxfilesize">Max File Size</option>
                            <option value="maxdimensions">Max Dimensions</option>
                        </select>
                    </div>

                    <div class="setting-group" id="pixelDimensions" style="display: none;">
                        <label for="resizeWidth">Width (px)</label>
                        <input type="number" id="resizeWidth" placeholder="Auto" min="1">
                        <label for="resizeHeight" style="margin-top: 10px;">Height (px)</label>
                        <input type="number" id="resizeHeight" placeholder="Auto" min="1">
                        <label style="margin-top: 10px; display: flex; align-items: center;">
                            <input type="checkbox" id="keepAspectRatio" checked style="margin-right: 8px;">
                            Keep aspect ratio
                        </label>
                    </div>

                    <div class="setting-group" id="percentageDimensions" style="display: none;">
                        <label for="resizePercentage">Percentage <span id="percentageValue">100</span>%</label>
                        <input type="range" id="resizePercentage" min="1" max="500" value="100">
                        <div class="preset-percentages">
                            <button class="percent-btn" data-percent="25">25%</button>
                            <button class="percent-btn" data-percent="50">50%</button>
                            <button class="percent-btn" data-percent="75">75%</button>
                            <button class="percent-btn" data-percent="200">200%</button>
                        </div>
                    </div>

                    <div class="setting-group" id="maxFileSizeGroup" style="display: none;">
                        <label for="maxFileSize">Max File Size</label>
                        <select id="maxFileSize">
                            <option value="100">100 KB</option>
                            <option value="250">250 KB</option>
                            <option value="500">500 KB</option>
                            <option value="1000">1 MB</option>
                            <option value="2000">2 MB</option>
                            <option value="5000">5 MB</option>
                        </select>
                        <small style="color: var(--text-secondary); display: block; margin-top: 5px;">
                            Image will be resized to fit within this file size
                        </small>
                    </div>

                    <div class="setting-group" id="maxDimensionsGroup" style="display: none;">
                        <label for="maxWidth">Max Width (px)</label>
                        <input type="number" id="maxWidth" placeholder="1000" min="1">
                        <label for="maxHeight" style="margin-top: 10px;">Max Height (px)</label>
                        <input type="number" id="maxHeight" placeholder="1000" min="1">
                    </div>
                </div>
            </div>

            <!-- Advanced Options - Collapsible -->
            <details class="settings-section collapsible-section">
                <summary>üîß Advanced Options</summary>
                <div class="settings-grid">
                    <div class="setting-group" id="multiFormatGroup">
                        <label>
                            <input type="checkbox" id="convertMultipleFormats">
                            Convert to Multiple Formats at Once
                        </label>
                        <div id="formatSelection" style="display: none; margin-top: 10px;">
                            <label style="display: flex; align-items: center; margin: 5px 0;">
                                <input type="checkbox" class="format-option" value="png" checked> PNG
                            </label>
                            <label style="display: flex; align-items: center; margin: 5px 0;">
                                <input type="checkbox" class="format-option" value="jpg" checked> JPG / JPEG
                            </label>
                            <label style="display: flex; align-items: center; margin: 5px 0;">
                                <input type="checkbox" class="format-option" value="webp"> WebP
                            </label>
                            <label style="display: flex; align-items: center; margin: 5px 0;">
                                <input type="checkbox" class="format-option" value="svg"> SVG
                            </label>
                            <label style="display: flex; align-items: center; margin: 5px 0;">
                                <input type="checkbox" class="format-option" value="bmp"> BMP
                            </label>
                            <label style="display: flex; align-items: center; margin: 5px 0;">
                                <input type="checkbox" class="format-option" value="gif"> GIF
                            </label>
                            <label style="display: flex; align-items: center; margin: 5px 0;">
                                <input type="checkbox" class="format-option" value="ico"> ICO
                            </label>
                            <label style="display: flex; align-items: center; margin: 5px 0;">
                                <input type="checkbox" class="format-option" value="avif"> AVIF
                            </label>
                        </div>
                    </div>

                    <div class="setting-group" id="backgroundColorGroup" style="display: none;">
                        <label for="backgroundColor">Background Color</label>
                        <div class="bg-color-options">
                            <input type="color" id="backgroundColor" value="#ffffff">
                            <button class="bg-preset-btn" data-color="#ffffff">White</button>
                            <button class="bg-preset-btn" data-color="#000000">Black</button>
                            <button class="bg-preset-btn" data-color="#transparent">Transparent</button>
                        </div>
                    </div>

                    <div class="setting-group" id="advancedOptions" style="display: none;">
                        <label for="cropShape">Crop Shape</label>
                        <select id="cropShape">
                            <option value="square">Square</option>
                            <option value="circle">Circle</option>
                            <option value="original">Original</option>
                        </select>
                    </div>

                    <div class="setting-group">
                        <label>
                            <input type="checkbox" id="autoPadding">
                            Auto Padding (Square Icons)
                        </label>
                    </div>

                    <div class="setting-group">
                        <label>
                            <input type="checkbox" id="autoSharpening">
                            Auto Sharpening (After Downscale)
                        </label>
                    </div>

                    <div class="setting-group">
                        <label>
                            <input type="checkbox" id="preserveTransparency" checked>
                            Preserve Transparency (if supported)
                        </label>
                    </div>

                    <div class="setting-group">
                        <label>
                            <input type="checkbox" id="removeMetadata">
                            Remove Metadata (smaller file size)
                        </label>
                    </div>

                    <div class="setting-group">
                        <label for="dpi">DPI/Resolution</label>
                        <select id="dpi">
                            <option value="72">72 DPI (Web)</option>
                            <option value="96">96 DPI (Standard)</option>
                            <option value="150">150 DPI (Print)</option>
                            <option value="300">300 DPI (High Print)</option>
                        </select>
                    </div>
                </div>
            </details>

            <!-- Output & File Options - Collapsible -->
            <details class="settings-section collapsible-section">
                <summary>üìÅ Output & File Options</summary>
                <div class="settings-grid">
                    <div class="setting-group">
                        <label for="customNaming">File Naming Pattern</label>
                        <select id="customNaming">
                            <option value="original_size">Original_Name_Size.format</option>
                            <option value="original_widthxheight">Original_Name_WxH.format</option>
                            <option value="size_only">Size.format</option>
                            <option value="custom">Custom Pattern</option>
                        </select>
                        <input type="text" id="customNamingPattern" placeholder="{name}_{width}x{height}.{format}" 
                               style="margin-top: 8px; display: none; width: 100%; padding: 8px; border-radius: 6px; border: 1px solid var(--border); background: var(--bg-tertiary); color: var(--text);">
                        <small style="color: var(--text-secondary); display: block; margin-top: 5px;">
                            Variables: {name}, {width}, {height}, {format}, {index}
                        </small>
                    </div>

                    <div class="setting-group">
                        <label for="zipFormat">Archive Format (Multiple Files)</label>
                        <select id="zipFormat">
                            <option value="zip">ZIP</option>
                            <option value="individual">Individual Files</option>
                        </select>
                    </div>

                    <div class="setting-group" id="zipOptionsGroup" style="display: none;">
                        <label for="zipCompressionLevel">ZIP Compression Level</label>
                        <select id="zipCompressionLevel">
                            <option value="fast">Fast (Lower compression)</option>
                            <option value="normal" selected>Normal</option>
                            <option value="maximum">Maximum (Best compression)</option>
                        </select>
                        
                        <label for="zipFileName" style="margin-top: 10px;">Custom ZIP Filename</label>
                        <input type="text" id="zipFileName" placeholder="converted_images" 
                               style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid var(--border); background: var(--bg-tertiary); color: var(--text);">
                        
                        <label style="margin-top: 10px; display: flex; align-items: center;">
                            <input type="checkbox" id="organizeByFormat" style="margin-right: 8px;">
                            Organize by format (PNG/, JPG/, etc.)
                        </label>
                        
                        <label style="margin-top: 5px; display: flex; align-items: center;">
                            <input type="checkbox" id="organizeBySize" style="margin-right: 8px;">
                            Organize by size
                        </label>
                    </div>

                    <div class="setting-group">
                        <label>
                            <input type="checkbox" id="folderImport">
                            Enable Folder Import
                        </label>
                    </div>
                </div>
            </details>

            <!-- Appearance - Collapsible -->
            <details class="settings-section collapsible-section">
                <summary>üé® Appearance</summary>
                <div class="settings-grid">
                    <div class="setting-group">
                        <label>
                            <input type="checkbox" id="autoTheme" checked>
                            Auto Theme (Dark/Light based on system)
                        </label>
                    </div>
                </div>
            </details>

            <div class="action-buttons">
                <button class="btn btn-primary" id="convertBtn">üîÑ Convert All Images</button>
                <button class="btn btn-secondary" id="clearBtn">üóëÔ∏è Clear All</button>
                <button class="btn btn-secondary" id="savePresetBtn">üíæ Save Current Settings as Preset</button>
                <button class="btn btn-secondary" id="historyBtn">üìú View History (Last 10)</button>
            </div>

            <!-- Custom User Presets -->
            <div class="user-presets-section" id="userPresetsSection" style="display: none;">
                <h4>üìå Your Custom Presets</h4>
                <div class="user-presets-list" id="userPresetsList"></div>
            </div>
        </section>

        <!-- Images Preview Grid -->
        <section class="images-grid" id="imagesGrid" style="display: none;">
            <h3>üì∏ Uploaded Images</h3>
            <div class="grid-container" id="gridContainer"></div>
        </section>

        <!-- Progress Section -->
        <section class="progress-section" id="progressSection" style="display: none;">
            <h3>‚è≥ Conversion Progress</h3>
            <div class="progress-container" id="progressContainer"></div>
        </section>

        <!-- Results Section -->
        <section class="results-section" id="resultsSection" style="display: none;">
            <h3>‚úÖ Conversion Complete</h3>
            <div class="results-container" id="resultsContainer"></div>
            <div class="download-actions">
                <button class="btn btn-success" id="downloadAllBtn">üì¶ Download All as ZIP</button>
            </div>
        </section>

        <!-- Conversion History -->
        <section class="history-section" id="historySection" style="display: none;">
            <h3>üìú Conversion History</h3>
            <div class="history-list" id="historyList"></div>
            <button class="btn btn-secondary" id="clearHistoryBtn">Clear History</button>
        </section>

        <!-- Custom Presets Modal -->
        <div class="modal" id="presetModal" style="display: none;">
            <div class="modal-content">
                <h3>üíæ Save Custom Preset</h3>
                <input type="text" id="presetName" placeholder="Preset name (e.g., My Logo Sizes)" 
                       style="width: 100%; padding: 12px; margin: 15px 0; border-radius: 8px; border: 1px solid var(--border); background: var(--bg-tertiary); color: var(--text);">
                <div class="modal-buttons">
                    <button class="btn btn-primary" id="savePresetConfirmBtn">Save</button>
                    <button class="btn btn-secondary" id="cancelPresetBtn">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Edit Custom Size Modal -->
        <div class="modal" id="editSizeModal" style="display: none;">
            <div class="modal-content">
                <h3>‚öôÔ∏è Edit Custom Size</h3>
                <div class="modal-form">
                    <div class="form-row">
                        <label>Width (px)</label>
                        <input type="number" id="editSizeWidth" min="1" class="modal-input">
                    </div>
                    <div class="form-row">
                        <label>Height (px)</label>
                        <input type="number" id="editSizeHeight" min="1" class="modal-input">
                    </div>
                    <div class="form-row">
                        <label>Output Format</label>
                        <select id="editSizeFormat" class="modal-input">
                            <option value="png">PNG</option>
                            <option value="jpg">JPG / JPEG</option>
                            <option value="jpeg">JPEG</option>
                            <option value="webp">WebP</option>
                            <option value="svg">SVG</option>
                            <option value="bmp">BMP</option>
                            <option value="gif">GIF</option>
                            <option value="ico">ICO</option>
                            <option value="avif">AVIF</option>
                            <option value="tiff">TIFF</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <label>Quality <span id="editQualityValue">80</span>%</label>
                        <input type="range" id="editSizeQuality" min="1" max="100" value="80" class="modal-input">
                    </div>
                    <div class="form-row">
                        <label>
                            <input type="checkbox" id="editSizeKeepAspect">
                            Keep aspect ratio
                        </label>
                    </div>
                    <div class="form-row">
                        <label>Background Color</label>
                        <input type="color" id="editSizeBackground" value="#ffffff" class="modal-input">
                    </div>
                    <div class="form-row">
                        <label>Resize Mode</label>
                        <select id="editSizeResizeMode" class="modal-input">
                            <option value="fit">Fit (Maintain Aspect)</option>
                            <option value="fill">Fill (Crop to Fit)</option>
                            <option value="stretch">Stretch</option>
                        </select>
                    </div>
                </div>
                <div class="modal-buttons">
                    <button class="btn btn-primary" id="saveSizeEditBtn">Save Changes</button>
                    <button class="btn btn-secondary" id="cancelSizeEditBtn">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Keyboard Shortcuts Help -->
        <div class="keyboard-help" id="keyboardHelp" style="display: none;">
            <h4>‚å®Ô∏è Keyboard Shortcuts</h4>
            <ul>
                <li><kbd>Ctrl/Cmd + U</kbd> - Upload files</li>
                <li><kbd>Ctrl/Cmd + Enter</kbd> - Convert all</li>
                <li><kbd>Ctrl/Cmd + Z</kbd> - Clear all</li>
                <li><kbd>Ctrl/Cmd + D</kbd> - Download all</li>
                <li><kbd>Ctrl/Cmd + H</kbd> - View history</li>
                <li><kbd>Esc</kbd> - Close modals</li>
            </ul>
        </div>

        <!-- API Section -->
        <section class="api-section">
            <details>
                <summary>üîå API Documentation</summary>
                <div class="api-content">
                    <h4>POST /api/convert</h4>
                    <p>Convert images via API</p>
                    <pre><code>{
  "format": "jpg",
  "quality": 80,
  "files": [base64 encoded images]
}</code></pre>
                    <p class="note">üí° Note: API endpoint requires server implementation. Current version works client-side only.</p>
                </div>
            </details>
        </section>
    </div>

    <footer>
        <p>üîí All processing is done in your browser. Your images are never uploaded to any server.</p>
        <p>‚ú® Works offline after first load (PWA enabled)</p>
    </footer>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="app.js"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then(reg => console.log('Service Worker registered'))
                    .catch(err => console.log('Service Worker registration failed'));
            });
        }
    </script>
</body>
</html>

